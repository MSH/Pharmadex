<!-- Creates the table with passed in values of product -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core">


    <p:panel header="#{msgs.applicant_detail}">


        <!-- Display the panel for company users -->
        <h:panelGroup rendered="#{userSession.company and  (empty regHomeData.applicant.applcntId)}">
            <h:outputLabel value="#{msgs.prodreghome_reg_info1}"/>
            <p:commandLink action="appregistration.faces" ajax="false"
                           value="Please click here to register an applicant."
                           immediate="true"/>
            <h:outputLabel value="#{msgs.prodreghome_reg_info2}"/>
            <h:outputLabel
                    value="#{msgs.prodreghome_reg_info3}"/>
        </h:panelGroup>

        <!-- Display the panel for staff users to select the applicant for which the application is being made -->
        <h:panelGroup rendered="#{userSession.staff and (empty regHomeData.applicant.applcntId)}">
            <h:outputLabel value="#{msgs.select_applicant_list}"/>
            <h:panelGrid columns="1" cellpadding="10px">
                <p:commandLink value="#{msgs.applicant_lookup}" oncomplete="PF('addapplicantDlg').show()"
                               immediate="true" style="font-weight: bolder; font-size: larger"/>
                <p:outputLabel value="#{msgs.applicant_lookup_info}" styleClass="hint"/>

            </h:panelGrid>
        </h:panelGroup>


        <h:panelGroup rendered="#{not empty regHomeData.applicant.applcntId}">
            <ui:decorate template="/templates/applicantdetailtmpl.xhtml">
                <ui:param name="applicantdata" value="#{regHomeData.applicant}"/>
                <ui:param name="input" value="false"/>
            </ui:decorate>
        </h:panelGroup>
    </p:panel>


    <h:panelGroup rendered="#{not empty regHomeData.applicant.applcntId}">
        <p:panel header="#{msgs.person_responsible}">
            <!--
                        <h:panelGroup id="nouser">
                            <h:panelGrid columns="1" columnClasses="label">
                                <h:outputLabel styleClass="label"
                                               value="No User present for the Applicant. Please update the applicant information by clicking on the link below"/>
                                <p:commandLink value="#{msgs.global_add}" action="/internal/processapp.faces"
                                               immediate="true" ajax="false">
                                    <f:setPropertyActionListener value="#{regHomeData.applicant.applcntId}" target="#{userSession.applcantID}"/>
                                </p:commandLink>
                            </h:panelGrid>

                        </h:panelGroup>
            -->

            <h:panelGroup id="userdetail">

                <ui:decorate template="/templates/userdetailtmpl.xhtml">
                    <ui:param name="userdata" value="#{regHomeData.applicantUser}"/>
                    <ui:param name="input" value="#{false}"/>
                </ui:decorate>
            </h:panelGroup>

        </p:panel>


    </h:panelGroup>

    <p:dialog header="#{msgs.user_add}" widgetVar="addapplicantDlg" id="addapplicantDlg">
        <h:form id="appdetailfrm">
            <h:panelGrid columns="2" cellspacing="5" columnClasses="label, value" styleClass="grid">
                <h:outputLabel value="#{msgs.applicant_name}" for="appname"/>
                <p:autoComplete id="appname" value="#{appSelectData.selectedApplicant}"
                                completeMethod="#{appSelectData.completeApplicantList}" dropdown="true"
                                var="it" itemLabel="#{it.appName}" itemValue="#{it.applcntId}" forceSelection="true"
                                converter="#{applicantConverter}">
                    <p:ajax event="itemSelect"
                            update=":reghome:appdetailfrm:appdetail :reghome:appdetailfrm:contact"
                            listener="#{appSelectData.appChangeListenener}" partialSubmit="true" process="@this"/>
                    <p:ajax event="change" listener="#{appSelectData.appChangeListenener}"
                            update=":reghome:appdetailfrm:appdetail :reghome:appdetailfrm:contact"
                            partialSubmit="true" process="@this"/>
                </p:autoComplete>

            </h:panelGrid>

            <h:panelGroup id="appdetail">
                <h:panelGrid columns="4" cellpadding="10px" cellspacing="6px" width="100%"
                             columnClasses="col1, col2, col1, col2" rendered="#{appSelectData.showApp}">
                    <p:outputLabel value="#{msgs.applicant_name}"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.appName}" style="font-weight: bold;"/>

                    <h:outputLabel/>
                    <h:outputLabel/>

                    <ui:decorate template="/templates/addrtempl.xhtml">
                        <ui:param name="addressdata" value="#{appSelectData.selectedApplicant.address}"/>
                        <ui:param name="input" value="false"/>
                    </ui:decorate>

                    <h:outputLabel/>
                    <h:outputLabel/>

                    <p:outputLabel value="#{msgs.applicant_type}*"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.applicantType}"
                                   style="font-weight: bold;"/>

                    <h:outputLabel/>
                    <h:outputLabel/>

                    <p:outputLabel value="#{msgs.applicant_filenumber}"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.fileNumber}" style="font-weight: bold;"/>

                    <p:outputLabel value="#{msgs.applicant_phone}" style="text-align: right"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.phoneNo}" style="font-weight: bold;"/>

                    <p:outputLabel value="#{msgs.applicant_faxno}"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.faxNo}" style="font-weight: bold;"/>

                    <p:outputLabel value="#{msgs.applicant_website}"/>
                    <p:outputLabel value="#{appSelectData.selectedApplicant.website}" style="font-weight: bold;"/>

                </h:panelGrid>
            </h:panelGroup>

            <p:panel header="#{msgs.person_responsible}" id="contact">

                <h:panelGroup id="nouser1"
                              rendered="#{empty appSelectData.selectedUser and !appSelectData.showUserSelect and not empty appSelectData.selectedApplicant}">
                    <h:panelGrid columns="1" columnClasses="label">
                        <h:outputLabel styleClass="label"
                                       value="No User present for the Applicant. Please update the applicant information by clicking on the link below"/>
                        <p:commandLink value="#{msgs.global_add}" action="/internal/processapp.faces"
                                       immediate="true" ajax="false">
                            <f:setPropertyActionListener value="#{appSelectData.selectedApplicant.applcntId}"
                                                         target="#{userSession.applcantID}"/>
                        </p:commandLink>
                    </h:panelGrid>

                </h:panelGroup>

                <h:panelGroup id="multipleuser1" rendered="#{appSelectData.showUserSelect}">
                    <p:dataTable id="usertable" var="applicantUser" value="#{appSelectData.users}"
                                 style="width:100%;" selection="#{appSelectData.selectedUser}"
                                 rowKey="#{applicantUser.userId}">
                        <p:ajax event="rowSelectRadio" listener="#{appSelectData.onRowSelect}"
                                update=":reghome:messages"/>

                        <p:column selectionMode="single"/>

                        <p:column headerText="#{msgs.User_name}">
                            <h:outputText value="#{applicantUser.name}"/>
                        </p:column>

                        <p:column headerText="#{msgs.User_username}">
                            <h:outputText value="#{applicantUser.username}"/>
                        </p:column>

                        <p:column headerText="#{msgs.User_email}">
                            <h:outputText value="#{applicantUser.email}"/>
                        </p:column>
                    </p:dataTable>

                </h:panelGroup>


                <h:panelGroup id="userdetail1" rendered="#{appSelectData.showUser}">

                    <ui:decorate template="/templates/userdetailtmpl.xhtml">
                        <ui:param name="userdata" value="#{appSelectData.selectedUser}"/>
                        <ui:param name="input" value="#{false}"/>
                    </ui:decorate>
                </h:panelGroup>

            </p:panel>


            <h:panelGrid columns="2" cellspacing="5" columnClasses="label, value" styleClass="grid">

                <h:panelGroup>
                    <p:commandButton value="#{msgs.global_add}" action="#{appSelectData.addApptoRegistration}"
                                     ajax="false" oncomplete="addapplicantDlg.hide()"/>
                    <p:commandButton action="#{appSelectData.cancelAddApplicant}" immediate="true"
                                     value="#{msgs.global_cancel}" update=":reghome:addapplicantDlg"/>
                </h:panelGroup>
                <h:outputLabel/>
            </h:panelGrid>
        </h:form>
    </p:dialog>

</ui:composition>
