<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
                template="../templates/process_reg_layout.xhtml">
<ui:define name="content">

<h:form id="reghome">
<p:growl id="growl" showDetail="true" showSummary="true"/>

<h:panelGrid columns="2" columnClasses="menu,content">
<h:panelGrid columns="2" columnClasses="menu,content">
<p:menu style="width:198px">
    <p:submenu label="#{msgs.Registration}">
        <p:menuitem value="#{msgs.global_save}" icon="ui-icon-disk" action="#{processProdBn.save}"
                    update="@form"/>
        <p:menuitem value="#{msgs.global_comment}" icon="ui-icon-document" onclick="dlg.show()"/>
        <p:menuitem value="#{msgs.global_nextstep}" icon="ui-icon-document" onclick="stepDlg.show()"
                    rendered="#{userSession.admin||processProdBn.checkReviewStatus||userSession.head}"/>
        <p:menuitem value="#{msgs.complete_review}" icon="ui-icon-gear" onclick="reviewDlg.show()"
                    rendered="#{userSession.reviewer and !processProdBn.module.complete}"/>
        <p:menuitem value="#{msgs.register_product}" icon="ui-icon-gear" onclick="regDlg.show()"
                    rendered="#{processProdBn.canRegister}"/>
        <p:menuitem value="#{msgs.assignmoderator}" icon="ui-icon-gear" onclick="moderatordlg.show()"
                    rendered="#{userSession.head||userSession.admin}"/>
    </p:submenu>
    <p:submenu label="#{msgs.post_registration}" rendered="#{processProdBn.registered}">
        <p:menuitem value="#{msgs.renew}" icon="ui-icon-gear" action="#{renewalMbn.preparePayment()}"
                    oncomplete="renewdlg.show()"
                    rendered="#{userSession.head||userSession.admin}" ajax="true"/>
        <p:menuitem value="#{msgs.issue_invoice}" icon="ui-icon-gear" oncomplete="invoicedlg.show()"
                    rendered="#{userSession.head||userSession.admin}" action="#{renewalMbn.initInvoice()}">
        </p:menuitem>
        <p:menuitem value="#{msgs.send_reminder}" icon="ui-icon-gear" action="#{renewalMbn.sendReminder}"
                    rendered="#{userSession.head||userSession.admin}" update=":reghome:growl"/>
        <p:menuitem value="#{msgs.report_payment}" icon="ui-icon-gear" action="#{renewalMbn.preparePayment()}"
                    oncomplete="reportpaymentdlg.show()"
                    rendered="#{userSession.company}" update=":reghome:growl" ajax="true"/>
        <p:menuitem value="#{msgs.amendment}" icon="ui-icon-gear" oncomplete="dlgAmdment.show()"
                    rendered="#{userSession.company||userSession.admin}" update=":reghome:growl"/>
        <!--        <p:menuitem value="#{msgs.amendment}" icon="ui-icon-gear" ajax="false" action="amdmtCategory.faces"
                            rendered="#{userSession.company||userSession.admin}" />
         -->
    </p:submenu>
</p:menu>


<h:panelGroup styleClass="ui-widget">
<h1 class="title ui-widget-header ui-corner-all">
    <table width="800px">
        <tr>
            <td>
                <h:outputLabel value="#{processProdBn.prodApplications.prod.prodName}" styleClass="title"
                               style="font-weight: bold; font-size: 1.5em"/>
            </td>
            <td align="right">
                <h:outputLabel value="Status: " style="font-weight: bold;color: #a52a2a;"/>
                <h:outputLabel value="#{msgs[processProdBn.prodApplications.regState.key]}"
                               style="font-weight: bold;color: #a52a2a;"/>
            </td>
        </tr>
        <tr>
            <td>
                <h:outputLabel value="Application Number: " styleClass="title"/>
                <h:outputFormat value="#{processProdBn.prodApplications.id}" styleClass="title"/>
            </td>
            <td align="right">
                <h:outputLabel value="Submitted Date: " styleClass="title"/>
                <h:outputFormat value="#{processProdBn.prodApplications.submitDate}"/>
            </td>
        </tr>
        <tr>
            <td>
                <h:outputLabel value="#{msgs.applicant_name}: " styleClass="title"/>
                <h:outputFormat value="#{processProdBn.prodApplications.prod.applicant.appName}"/>
            </td>
            <td align="right">
                <h:outputLabel value="#{msgs.expiry_date}: " styleClass="title" rendered="#{processProdBn.registered}"/>
                <h:outputFormat value="#{processProdBn.prodApplications.regExpiryDate}"/>
            </td>
        </tr>
    </table>
</h1>

<pe:timeline id="timeline" value="#{processProdBn.timelinesChartData}"
             axisPosition="top"
             showNavigation="true"
             eventStyle="box"
             height="130px" width="830px">
</pe:timeline>

<p:messages id="messages" showDetail="true" showSummary="true"/>

<p:tabView id="processtab" style="width: 830px;" dynamic="true" cache="true">
<p:tab title="Application Information" id="infotab">
    <ui:decorate template="/templates/prodappsummarytmpl.xhtml">
        <ui:param name="prodAppData" value="#{processProdBn.prodApplications}"/>
    </ui:decorate>
</p:tab>

<p:tab title="Comments">
    <p:commandButton icon="ui-icon-document" value="Add Comment" onclick="dlg.show()"/>

    <p:dataTable id="commenttable" value="#{processProdBn.comments}" var="it">
        <p:column style="width:120px;">
            <p:outputLabel styleClass="ui-icon ui-icon-comment" style="display:inline-block;"/>
            <p:outputLabel value="#{it.user.name}" styleClass="label"/>

            <div style="font-size: smaller;">
                <h:outputLabel converter="javax.faces.DateTime" value="#{it.date}"/>
            </div>
        </p:column>

        <p:column>
            <div style="padding-left:10px;padding-top:10px;">
                <h:outputText value="#{it.comment}"
                              escape="false"
                              styleClass="text"/>
            </div>
        </p:column>
    </p:dataTable>


</p:tab>

<p:tab title="#{msgs.amdmt_history}">

    <p:dataTable id="amdmtHist" value="#{processProdBn.prodAppAmdmts}" var="amdmt">
        <p:column headerText="#{msgs.amdmt_type}">
            <h:outputText value="#{amdmt.amdmtCategory.amdmtType}"/>
        </p:column>

        <p:column headerText="#{msgs.amdmt_code}">
            <h:outputText value="#{amdmt.amdmtCategory.categoryCD}"/>
        </p:column>

        <p:column headerText="#{msgs.submitted_date}">
            <p:commandLink action="/internal/amdmtdetailsDlg.faces" ajax="false">
                <h:outputText converter="javax.faces.DateTime" value="#{amdmt.createdDate}"/>
                <f:setPropertyActionListener value="#{amdmt}" target="#{amdmtProcessMBean.prodAppAmdmt}"/>
            </p:commandLink>
        </p:column>

        <p:column headerText="#{msgs.amdmt_state}">
            <h:outputText value="#{amdmt.amdmtState}"/>
        </p:column>

        <p:column headerText="#{msgs.submitted_by}">
            <h:outputText value="#{amdmt.submittedBy.username}"/>
        </p:column>
    </p:dataTable>
</p:tab>

<p:tab title="Verification" id="verficationtab" rendered="#{userSession.admin||userSession.staff}">

    <h:outputLabel value="Ensure that Fees is recieved" style="font-weight: bold; font-size: larger;"/>
    <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="20">
        <h:outputLabel value="Fees Recieved?"/>
        <h:panelGroup>
            <p:selectBooleanCheckbox value="#{processProdBn.prodApplications.feeReceived}"/>
            <h:outputLabel value=" Yes"/>
        </h:panelGroup>
    </h:panelGrid>

    <h:outputLabel value="Ensure that applicant details are complete"
                   style="font-weight: bold; font-size: larger;"/>
    <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="20">
        <h:outputLabel value="Applicant Details Complete?"/>
        <h:panelGroup>
            <p:selectBooleanCheckbox value="#{processProdBn.prodApplications.applicantVerified}"/>
            <h:outputLabel value=" Yes"/>
        </h:panelGroup>
    </h:panelGrid>

    <h:outputLabel value="Check that medicine inputs are correct" style="font-weight: bold; font-size: larger;"/>
    <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="20">
        <h:outputLabel value="Medicine application complete?"/>
        <h:panelGroup>
            <p:selectBooleanCheckbox value="#{processProdBn.prodApplications.productVerified}"/>
            <h:outputLabel value=" Yes"/>
        </h:panelGroup>
    </h:panelGrid>

    <h:outputLabel value="Check that Dossier is recieved and complete"
                   style="font-weight: bold; font-size: larger;"/>
    <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="20">
        <h:outputLabel value="Dossier recieved and complete?"/>
        <h:panelGroup>
            <p:selectBooleanCheckbox value="#{processProdBn.prodApplications.dossierReceived}"/>
            <h:outputLabel value=" Yes"/>
        </h:panelGroup>
    </h:panelGrid>

    <h:outputLabel value="Issue acknowledgement letter" style="font-weight: bold; font-size: larger;"/>
    <h:outputLabel/>
    <h:panelGrid columns="1" style="margin-bottom:10px" cellpadding="20">
        <h:outputLabel value="Acknowledgement letter details"/>
        <p:inputText/>
    </h:panelGrid>


</p:tab>

<p:tab title="CheckLists" rendered="#{userSession.admin||userSession.staff}" id="checklisttab">
    <p:dataTable var="checkList" value="#{processProdBn.checklists}" style="width:100%;">
        <p:column headerText="">
            <h:outputLabel value="#{checkList.checklist.moduleNo}"/>
        </p:column>
        <p:column>
            <h:outputLabel value="#{checkList.checklist.name}"/>
        </p:column>
        <p:column>
            <h:outputLabel value="#{checkList.checklist.module}"/>
        </p:column>
        <p:column headerText="Applicant">
            <p:selectBooleanCheckbox value="#{checkList.value}"/>
        </p:column>
        <p:column headerText="Staff">
            <p:selectBooleanCheckbox value="#{checkList.staffValue}"/>
        </p:column>
        <p:column>
            <p:inputText value="#{checkList.staffComment}"/>
        </p:column>
        <p:column>
            <p:commandButton icon="ui-icon-document" onclick="moduledlg.show()"
                             action="#{fileUploadController.setProdAppChecklist(checkList)}"
                             rendered="#{!checkList.fileUploaded}"/>

        </p:column>
        <p:column>
            <p:commandButton id="downloadLink" value="Download" ajax="false"
                             onclick="PrimeFaces.monitorDownload(start, stop)"
                             icon="ui-icon-arrowstop-1-s" rendered="#{checkList.fileUploaded}"
                    >
                <p:fileDownload value="#{fileUploadController.moduleDocDownload(checkList)}"/>
            </p:commandButton>
        </p:column>
    </p:dataTable>
</p:tab>

<p:tab title="Timeline" rendered="#{userSession.admin||userSession.staff}" id="timelinetab">

    <p:panel header="Status Update of Application">

        <p:dataTable id="timelinetbl" var="timeline" value="#{processProdBn.timeLineList}">
            <f:facet name="header">
                Shows the evolution of the Product Registration.
            </f:facet>

            <p:column headerText="Application Status">
                <h:outputText value="#{msgs[timeline.regState.key]}"
                              style="font-weight: bolder; font-size: large;"/>
            </p:column>

            <p:column headerText="Status Change Date">
                <h:outputLabel converter="javax.faces.DateTime" value="#{timeline.statusDate}"/>
            </p:column>

            <p:column headerText="Status updated by">
                #{timeline.user.name}
            </p:column>

        </p:dataTable>

    </p:panel>

</p:tab>

<p:tab title="Attachments" id="attachtab" rendered="#{userSession.admin||userSession.staff}">

    <p:commandButton icon="ui-icon-document" value="#{msgs.adddocument}" oncomplete="attachdlg.show()"
                     action="#{fileUploadController.prepareUpload}"
                     update=":reghome:attachdlg"/>

    <p:dataTable id="attachtable" value="#{fileUploadController.attachments}" var="doc">

        <p:column headerText="#{msgs.title}">
            <h:outputText value="#{doc.title}"/>
        </p:column>

        <p:column headerText="#{msgs.filename}">
            <h:outputText value="#{doc.fileName}"/>
        </p:column>

        <p:column headerText="#{msgs.uploaddate}">
            <h:outputText converter="javax.faces.DateTime" value="#{doc.createdDate}"/>
        </p:column>

        <p:column headerText="#{msgs.uploadedby}">
            <h:outputText value="#{doc.uploadedBy.name}"/>
        </p:column>

        <p:column headerText="#{msgs.registration_status}">
            <h:outputText value="#{msgs[doc.regState.key]}"/>
        </p:column>

        <p:column>
            <p:commandButton id="downloadLink" value="Download" ajax="false"
                             onclick="PrimeFaces.monitorDownload(start, stop)"
                             icon="ui-icon-arrowthichk-s">
                <p:fileDownload value="#{fileUploadController.fileDownload(doc)}"/>
            </p:commandButton>
        </p:column>

        <p:column>
            <p:commandButton id="deleteattach" action="#{fileUploadController.deleteDoc(doc)}" ajax="false"
                             icon="ui-icon-trash"
                             update=":reghome:attachtab:attachtable"/>
        </p:column>
    </p:dataTable>
</p:tab>

<p:tab title="Additional Information" id="addinfotab" rendered="#{userSession.admin||userSession.staff}">

    <p:dataTable id="invoicetable" value="#{processProdBn.invoices}" var="invoice">
        <p:column headerText="#{msgs.invoice_no}">
            <p:commandLink value="#{invoice.invoiceNumber}" oncomplete="invoicedlg.show()">
                <f:setPropertyActionListener value="#{invoice}" target="#{renewalMbn.invoice}"/>
            </p:commandLink>
        </p:column>
        <p:column headerText="#{msgs.invoice_amt}">
            <h:outputText value="#{invoice.invoiceAmt}"/>
        </p:column>
        <p:column headerText="#{msgs.invoice_type}">
            <h:outputText value="#{invoice.invoiceType}"/>
        </p:column>
        <p:column headerText="#{msgs.payment_status}">
            <h:outputText value="#{invoice.paymentStatus}"/>
        </p:column>
        <p:column headerText="#{msgs.send_reminder}">
            <p:commandLink value="#{msgs.send_reminder}" action="#{renewalMbn.sendReminder}"
                           update=":reghome:growl :reghome:processtab:mailtable ">
                <f:setPropertyActionListener value="#{invoice}" target="#{renewalMbn.invoice}"/>
            </p:commandLink>
        </p:column>
        <p:column headerText="#{msgs.Home_download}">
            <p:commandButton id="invoicedownload" value="#{msgs.Home_download}" ajax="false"
                             onclick="PrimeFaces.monitorDownload(start, stop)"
                             icon="ui-icon-arrowthichk-s">
                <p:fileDownload value="#{fileUploadController.invoiceDownload(invoice)}"/>
            </p:commandButton>
        </p:column>
    </p:dataTable>

    <p:separator/>

    <p:commandButton icon="ui-icon-document" value="Send Applicant Mail" onclick="maildlg.show()"/>
    <p:dataTable id="mailtable" value="#{processProdBn.mails}" var="mail" style="width: 830px;">
        <p:column style="width:120px;" headerText="Date">
            <div class="icon-user" style="float:left;"/>
            <b>#{it.user.name}</b>

            <div style="font-size: smaller;">
                <h:outputLabel converter="javax.faces.DateTime" value="#{mail.date}"/>
            </div>
        </p:column>

        <p:column headerText="Subject">
            <div style="padding-left:10px;padding-top:10px;">
                <h:outputText value="#{mail.subject}"
                              escape="false"
                              styleClass="text"/>
            </div>
        </p:column>

        <p:column headerText="Message">
            <div style="padding-left:10px;padding-top:10px;">
                <h:outputText value="#{mail.message}"
                              escape="false"
                              styleClass="text"/>
            </div>
        </p:column>

        <p:column headerText="Sent By">
            <div style="padding-left:10px;padding-top:10px;">
                <h:outputText value="#{mail.user.name}"
                              escape="false"
                              styleClass="text"/>
            </div>
        </p:column>

    </p:dataTable>

</p:tab>

<p:tab title="#{msgs.reg_cert}" id="regcerttab" rendered="#{processProdBn.registered}">

    <p:commandButton id="invoicedownload" value="#{msgs.reg_cert}" ajax="false"
                     onclick="PrimeFaces.monitorDownload(start, stop)"
                     icon="ui-icon-arrowthichk-s">
        <p:fileDownload value="#{fileUploadController.regCertDownload()}"/>
    </p:commandButton>
</p:tab>

<p:tab title="#{msgs.processor}" id="processor" rendered="#{userSession.moderator}">
    <p:commandButton icon="ui-icon-document" value="#{msgs.assignprocessor}" onclick="processordlg.show()"/>

    <p:panelGrid columns="5" columnClasses="label value" rendered="#{processProdBn.module != null}" id="processpnl">

        <h:outputText value="#{msgs.module}"/>
        <h:outputText value="#{msgs.processor}" style="font-weight: bold;"/>
        <h:outputText value="#{msgs.assigndate}" style="font-weight: bold;"/>
        <h:outputText value="#{msgs.completeddate}" style="font-weight: bold;"/>
        <h:outputText value="#{msgs.review_comment}" style="font-weight: bold;"/>


        <h:outputText value="Module 1 Reviewer: "/>

        <h:outputText value="#{processProdBn.module.module1.name}" escape="false"/>

        <h:outputText value="#{processProdBn.module.assignDate}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <h:outputText value="#{processProdBn.module.module1SubmitDt}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <p:commandButton icon="ui-icon-document" oncomplete="dlgRevComment.show()"
                         rendered="#{processProdBn.module.review1 != null}"
                         action="#{processProdBn.setReviewComment(processProdBn.module.review1)}"
                         update=":reghome:dlgRevComment"/>
        <p:outputLabel rendered="#{processProdBn.module.review1 == null}"/>


        <h:outputText value="Module 2 Reviewer: "
                      escape="false"/>

        <h:outputText value="#{processProdBn.module.module2.name}"
                      escape="false"/>

        <h:outputText value="#{processProdBn.module.assignDate}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <h:outputText value="#{processProdBn.module.module2SubmitDt}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <p:commandButton icon="ui-icon-document" oncomplete="dlgRevComment.show()"
                         rendered="#{processProdBn.module.review2 != null}"
                         action="#{processProdBn.setReviewComment(processProdBn.module.review2)}"
                         update=":reghome:dlgRevComment"/>
        <p:outputLabel rendered="#{processProdBn.module.review2 == null}"/>


        <h:outputText value="Module 3 Reviewer: "
                      escape="false"/>

        <h:outputText value="#{processProdBn.module.module3.name}" escape="false"/>

        <h:outputText value="#{processProdBn.module.assignDate}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <h:outputText value="#{processProdBn.module.module3SubmitDt}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>


        <p:commandButton icon="ui-icon-document" oncomplete="dlgRevComment.show()"
                         rendered="#{processProdBn.module.review3 != null}"
                         action="#{processProdBn.setReviewComment(processProdBn.module.review3)}"
                         update=":reghome:dlgRevComment"/>
        <p:outputLabel rendered="#{processProdBn.module.review3 == null}"/>


        <h:outputText value="Module 4 Reviewer: "
                      escape="false"/>

        <h:outputText value="#{processProdBn.module.module4.name}"
                      escape="false"/>

        <h:outputText value="#{processProdBn.module.assignDate}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <h:outputText value="#{processProdBn.module.module4SubmitDt}">
            <f:convertDateTime dateStyle="medium" type="date"/>
        </h:outputText>

        <p:commandButton icon="ui-icon-document" oncomplete="dlgRevComment.show()"
                         rendered="#{processProdBn.module.review4 != null}"
                         action="#{processProdBn.setReviewComment(processProdBn.module.review4)}"
                         update=":reghome:dlgRevComment"/>
        <p:outputLabel rendered="#{processProdBn.module.review4 == null}"/>

    </p:panelGrid>


</p:tab>

</p:tabView>

<p:dialog header="Add Comment" widgetVar="dlg" resizable="false" id="commentdlg" modal="true">

    <h:panelGrid columns="2" style="margin-bottom:10px">
        <h:outputLabel for="commenttext" value="Enter Comment:"/>
        <p:inputTextarea id="commenttext" value="#{processProdBn.selComment.comment}" rows="5" cols="50"/>
        <h:outputLabel value="Internal Comment"/>
        <p:selectBooleanCheckbox value="#{processProdBn.selComment.internal}" itemLabel="Yes"/>
    </h:panelGrid>

    <p:commandButton id="submitButton" value="Submit" action="#{processProdBn.addComment}"
                     oncomplete="dlg.hide()"
                     update=":reghome:processtab:commenttable :reghome:commentdlg :reghome:growl :reghome:messages"/>

</p:dialog>


<p:dialog header="Assign Moderator" widgetVar="moderatordlg" resizable="false" id="moderatordlg" modal="true"
          rendered="#{userSession.head||userSession.admin}">

    <p:panelGrid columns="2" columnClasses="label value">
        <h:outputText value="Moderator: "
                      escape="false"
                      styleClass="text"/>

        <p:autoComplete id="mod" value="#{processProdBn.prodApplications.moderator}"
                        completeMethod="#{processProdBn.completeModeratorList}" dropdown="true"
                        var="it" itemLabel="#{it.name}" itemValue="#{it.userId}" forceSelection="true"
                        converter="#{userConverter}">
        </p:autoComplete>

    </p:panelGrid>


    <p:commandButton id="submitmoderator" value="Submit" action="#{processProdBn.assignModerator}"
                     oncomplete="moderatordlg.hide()" ajax="false"/>

</p:dialog>


<p:dialog header="#{msgs.adddocument}" widgetVar="attachdlg" resizable="false" id="attachdlg" modal="true">

    <h:panelGrid columns="2" style="margin-bottom:10px">
        <h:outputLabel for="attachtitle" value="#{msgs.title}"/>
        <p:inputText id="attachtitle" value="#{fileUploadController.attach.title}"/>
        <h:outputLabel for="attachcomment" value="#{msgs.global_comment}"/>
        <p:inputTextarea id="attachcomment" value="#{fileUploadController.attach.comment}" rows="5" cols="50"/>
    </h:panelGrid>

    <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                  mode="advanced"
                  update=":reghome:growl :reghome:messages"
                  multiple="false"
                  sizeLimit="10000000">

    </p:fileUpload>

    <p:commandButton id="adddoc" value="Submit" action="#{fileUploadController.addDocument}"
                     oncomplete="attachdlg.hide()" ajax="false"
                     update="reghome:processtab:attachtable :reghome:growl :reghome:messages"/>

</p:dialog>

<p:dialog header="#{msgs.adddocument}" widgetVar="moduledlg" resizable="false" id="moduleDlg" modal="true">


    <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                  mode="advanced"
                  auto="true"
                  update=":reghome:growl :reghome:messages"
                  multiple="false"
                  sizeLimit="10000000">

    </p:fileUpload>

    <p:commandButton id="addmoduledoc" value="Submit" action="#{fileUploadController.addModuleDoc}"
                     oncomplete="moduledlg.hide()" ajax="false"
                     update="reghome:processtab:attachtable :reghome:growl :reghome:messages"/>

</p:dialog>


<p:dialog header="#{msgs.next_step}" widgetVar="stepDlg" resizable="false" modal="true"
          rendered="#{userSession.admin||processProdBn.checkReviewStatus||userSession.head}">

    <h:panelGrid columns="2" style="margin-bottom:10px">
        <h:outputLabel for="statuscb" value="Status: "/>
        <p:selectOneMenu id="statuscb" value="#{processProdBn.timeLine.regState}">
            <f:selectItems value="#{processProdBn.regSate}" var="type" itemLabel="#{msgs[type.key]}"/>
        </p:selectOneMenu>
        <h:outputLabel for="steptext" value="Enter Comment:"/>
        <p:inputTextarea id="steptext" value="#{processProdBn.timeLine.comment}" rows="5" cols="50"/>
    </h:panelGrid>

    <p:commandButton id="submittimeline" value="Submit" action="#{processProdBn.addTimeline}"
                     oncomplete="stepDlg.hide()" ajax="false"/>

</p:dialog>

<p:dialog header="#{msgs.register_product}" widgetVar="regDlg" resizable="false" id="regDlg" modal="true"
          rendered="#{processProdBn.canRegister}">

    <h:panelGrid columns="2" style="margin-bottom:10px">
        <h:outputLabel value="#{msgs.registration_date}"/>
        <p:calendar value="#{processProdBn.prodApplications.registrationDate}" id="regDate" showOn="button"
                    required="true"/>
        <h:outputLabel value="#{msgs.expiry_date}"/>
        <p:calendar value="#{processProdBn.prodApplications.regExpiryDate}" id="expiryDate" showOn="button"
                    required="true"/>

        <p:menuitem value="#{msgs.register_product}" icon="ui-icon-gear" action="#{processProdBn.registerProduct}"
                    update="@form" rendered="#{processProdBn.readyReg}"/>

    </h:panelGrid>

    <p:commandButton id="regBtn" value="#{msgs.register_product}" action="#{processProdBn.registerProduct}"
                     oncomplete="regDlg.hide()"
                     update=":reghome:growl :reghome:messages :reghome"/>

</p:dialog>

<p:dialog header="#{msgs.issue_invoice}" widgetVar="invoicedlg" resizable="true" id="invoicedlg" modal="true">

    <h:panelGrid columns="4" columnClasses="col1 col2 col1 col2" cellpadding="10" cellspacing="10">
        <p:outputLabel value="#{msgs.reg_number}"/>
        <h:outputText value="#{renewalMbn.selProd.regNo}"/>

        <p:outputLabel value="#{msgs.prodName}"/>
        <h:outputText value="#{renewalMbn.selProd.prodName}"/>

        <p:outputLabel value="#{msgs.prodgenname}"/>
        <h:outputText value="#{renewalMbn.selProd.genName}"/>

        <p:outputLabel value="#{msgs.applicant_name}"/>
        <h:outputText value="#{renewalMbn.selProd.applicant.appName}"/>

        <p:outputLabel value="#{msgs.expiry_date}"/>
        <h:outputText value="#{renewalMbn.selProd.prodApplications.regExpiryDate}"/>

        <p:outputLabel value="#{msgs.new_ecpiry_date}" for="newexpiryDate"/>
        <p:calendar value="#{renewalMbn.invoice.newExpDate}" id="newexpiryDate" showOn="button"/>

        <p:outputLabel value="#{msgs.invoice_amt}" for="invamt"/>
        <p:inputText value="#{renewalMbn.invoice.invoiceAmt}" id="invamt"/>

        <p:outputLabel value="#{msgs.invoice_no}" for="invno"/>
        <p:inputText value="#{renewalMbn.invoice.invoiceNumber}" id="invno"/>

    </h:panelGrid>

    <h:panelGrid columns="2" style="margin-top:10px">
        <p:commandButton id="createinvoice" value="#{msgs.global_submit}" oncomplete="invoicedlg.hide()"
                         icon="ui-icon-disk" ajax="true" action="#{renewalMbn.createInvoice}"/>
        <p:commandButton id="cnclinvoice" type="button" value="Clear" onclick="invoicedlg.hide()"
                         icon="ui-icon-close" ajax="false"/>
    </h:panelGrid>
</p:dialog>

<p:dialog header="#{msgs.report_payment}" widgetVar="reportpaymentdlg" resizable="true" id="reportpaymentdlg"
          modal="true">

    <h:panelGrid columns="4" columnClasses="col1 col2 col1 col2" cellpadding="10" cellspacing="10">
        <p:outputLabel value="#{msgs.reg_number}"/>
        <h:outputText value="#{renewalMbn.selProd.regNo}"/>

        <p:outputLabel value="#{msgs.prodName}"/>
        <h:outputText value="#{renewalMbn.selProd.prodName}"/>

        <p:outputLabel value="#{msgs.prodgenname}"/>
        <h:outputText value="#{renewalMbn.selProd.genName}"/>

        <p:outputLabel value="#{msgs.applicant_name}"/>
        <h:outputText value="#{renewalMbn.selProd.applicant.appName}"/>

        <p:outputLabel value="#{msgs.expiry_date}"/>
        <h:outputText value="#{renewalMbn.selProd.prodApplications.regExpiryDate}"/>

        <p:outputLabel value="#{msgs.new_ecpiry_date}" for="newexpiryDate"/>
        <h:outputText value="#{renewalMbn.invoice.newExpDate}"/>

        <p:outputLabel value="#{msgs.invoice_amt}" for="payinvamt"/>
        <h:outputText value="#{renewalMbn.invoice.invoiceAmt}" id="payinvamt"/>

        <p:outputLabel value="#{msgs.invoice_no}" for="payinvno"/>
        <h:outputText value="#{renewalMbn.invoice.invoiceNumber}" id="payinvno"/>

        <p:outputLabel value="#{msgs.payment_amt}" for="payamt"/>
        <p:inputText value="#{renewalMbn.payment.paymentAmt}" id="payamt"/>

        <p:outputLabel value="#{msgs.reciept_no}" for="receiptNo"/>
        <p:inputText value="#{renewalMbn.payment.receiptNo}" id="receiptNo"/>

        <p:outputLabel value="#{msgs.tracking_no}" for="trackingNo"/>
        <p:inputText value="#{renewalMbn.payment.trackingNo}" id="trackingNo"/>

    </h:panelGrid>

    <h:panelGrid columns="2" style="margin-top:10px">
        <p:commandButton id="reportpayment" value="#{msgs.global_submit}" oncomplete="reportpaymentdlg.hide()"
                         icon="ui-icon-disk" ajax="true" action="#{renewalMbn.reportPayment}"/>
        <p:commandButton id="cnclpayment" type="button" value="Clear" onclick="reportpaymentdlg.hide()"
                         icon="ui-icon-close" ajax="false"/>
    </h:panelGrid>
</p:dialog>

<p:dialog header="#{msgs.renew}" widgetVar="renewdlg" resizable="true" id="renewdlg"
          modal="true">

    <h:panelGrid columns="4" columnClasses="col1 col2 col1 col2" cellpadding="10" cellspacing="10">
        <p:outputLabel value="#{msgs.reg_number}"/>
        <h:outputText value="#{renewalMbn.selProd.regNo}"/>

        <p:outputLabel value="#{msgs.prodName}"/>
        <h:outputText value="#{renewalMbn.selProd.prodName}"/>

        <p:outputLabel value="#{msgs.prodgenname}"/>
        <h:outputText value="#{renewalMbn.selProd.genName}"/>

        <p:outputLabel value="#{msgs.applicant_name}"/>
        <h:outputText value="#{renewalMbn.selProd.applicant.appName}"/>

        <p:outputLabel value="#{msgs.expiry_date}"/>
        <h:outputText value="#{renewalMbn.selProductApp.regExpiryDate}"/>

        <p:outputLabel value="#{msgs.new_ecpiry_date}"/>
        <h:outputText value="#{renewalMbn.invoice.newExpDate}"/>

        <p:outputLabel value="#{msgs.invoice_amt}"/>
        <h:outputText value="#{renewalMbn.invoice.invoiceAmt}"/>

        <p:outputLabel value="#{msgs.invoice_no}"/>
        <h:outputText value="#{renewalMbn.invoice.invoiceNumber}"/>

        <p:outputLabel value="#{msgs.payment_amt}"/>
        <h:outputText value="#{renewalMbn.payment.paymentAmt}"/>

        <p:outputLabel value="#{msgs.reciept_no}"/>
        <h:outputText value="#{renewalMbn.payment.receiptNo}"/>

        <p:outputLabel value="#{msgs.tracking_no}"/>
        <h:outputText value="#{renewalMbn.payment.trackingNo}"/>

    </h:panelGrid>

    <h:panelGrid columns="2" style="margin-top:10px">
        <p:commandButton value="#{msgs.global_submit}" oncomplete="renewdlg.hide()"
                         icon="ui-icon-disk" ajax="false" action="#{renewalMbn.renew}"/>
        <p:commandButton type="button" value="Clear" onclick="renewdlg.hide()"
                         icon="ui-icon-close" ajax="false"/>
    </h:panelGrid>
</p:dialog>


<p:dialog header="#{msgs.complete_review}" widgetVar="reviewDlg" resizable="true" id="reviewDlg" modal="true">
    <p:editor id="editor" value="#{processProdBn.reviewComment}" width="800" height="500"/>

    <h:panelGrid columns="2" style="margin-top:10px">
        <p:commandButton id="submitReview" value="#{msgs.global_submit}" oncomplete="reviewDlg.hide()"
                         icon="ui-icon-disk" ajax="true" action="#{processProdBn.submitReview}"/>
        <p:commandButton id="clearButton" type="button" value="Clear" onclick="reviewDlg.hide()"
                         icon="ui-icon-close" ajax="false"/>
    </h:panelGrid>
</p:dialog>

<p:dialog header="Review Comment" widgetVar="dlgRevComment" showEffect="fade" hideEffect="fade" modal="true"
          id="dlgRevComment" minHeight="500" minWidth="800">
    <h:outputText id="editordisplay" value="#{processProdBn.reviewComment}" escape="false"/>
</p:dialog>

<p:dialog header="#{msgs.amendment}" widgetVar="dlgAmdment" showEffect="fade" hideEffect="fade" modal="true"
          id="dlgAmdment" width="800px" height="500px">
    <ui:include src="amdmtCategoryDlg.xhtml"/>

</p:dialog>

<p:dialog modal="true" widgetVar="statusDialog" header="Status" draggable="false" closable="false" resizable="false">
    <p:graphicImage value="/design/ajaxloadingbar.gif"/>
</p:dialog>

<p:dialog header="Send Mail" widgetVar="maildlg" resizable="false" modal="true">

    <h:panelGrid columns="2" style="margin-bottom:10px">
        <h:outputLabel for="tomail" value="To: "/>
        <h:inputText id="tomail" value="#{processProdBn.mail.mailto}"/>
        <h:outputLabel for="subject" value="Subject: "/>
        <h:inputText id="subject" value="#{processProdBn.mail.subject}"/>
        <h:outputLabel for="message" value="Message:"/>
        <p:inputTextarea id="message" value="#{processProdBn.mail.message}" rows="10" cols="50"/>
    </h:panelGrid>

    <p:commandButton id="sendmessage" value="Submit" action="#{processProdBn.sendMessage}"
                     oncomplete="mailDlg.hide()" update="@form"/>

</p:dialog>

</h:panelGroup>
</h:panelGrid>
</h:panelGrid>
</h:form>
<p:dialog header="Assign Reviewer" widgetVar="processordlg" resizable="false" id="processorDlg" modal="true"
          rendered="#{userSession.moderator}">
    <h:form id="processfrm">

        <p:panel>
            <h:panelGrid columns="2" columnClasses="label value">
                <h:outputText value="Module 1: "
                              escape="false"
                              styleClass="text"/>

                <p:autoComplete id="module1" value="#{processProdBn.module.module1}"
                                completeMethod="#{processProdBn.completeProcessorList}" dropdown="true"
                                var="it" itemLabel="#{it.name}" itemValue="#{it.userId}" forceSelection="true"
                                converter="#{userConverter}">
                </p:autoComplete>

                <h:outputText value="Module 2: "
                              escape="false"
                              styleClass="text"/>

                <p:autoComplete id="module2" value="#{processProdBn.module.module2}"
                                completeMethod="#{processProdBn.completeProcessorList}" dropdown="true"
                                var="it" itemLabel="#{it.name}" itemValue="#{it.userId}" forceSelection="true"
                                converter="#{userConverter}">
                </p:autoComplete>

                <h:outputText value="Module 3: "
                              escape="false"
                              styleClass="text"/>

                <p:autoComplete id="module3" value="#{processProdBn.module.module3}"
                                completeMethod="#{processProdBn.completeProcessorList}" dropdown="true"
                                var="it" itemLabel="#{it.name}" itemValue="#{it.userId}" forceSelection="true"
                                converter="#{userConverter}">
                </p:autoComplete>

                <h:outputText value="Module 4: "
                              escape="false"
                              styleClass="text"/>

                <p:autoComplete id="module4" value="#{processProdBn.module.module4}"
                                completeMethod="#{processProdBn.completeProcessorList}" dropdown="true"
                                var="it" itemLabel="#{it.name}" itemValue="#{it.userId}" forceSelection="true"
                                converter="#{userConverter}">
                </p:autoComplete>

            </h:panelGrid>


            <p:commandLink id="submitButton1" value="Submit" action="#{processProdBn.assignProcessor}"
                           oncomplete="processordlg.hide()"
                           update=":reghome:processtab:processpnl :reghome:messages"/>
        </p:panel>

    </h:form>
</p:dialog>
</ui:define>
<script type="text/javascript">
    function start() {
        statusDialog.show();
    }

    function stop() {
        statusDialog.hide();
    }
</script>
</ui:composition>


