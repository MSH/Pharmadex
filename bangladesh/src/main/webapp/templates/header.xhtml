<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sec="http://www.springframework.org/security/facelets/tags">
<title>#{msgs.header_title}</title>
<h:outputStylesheet library="css" name="standard.css"/>
<h:outputScript library="js" name="calendar.js"/>

<style>
    ul.ui-menu-child {
        white-space: nowrap;
        width: 220px !important;
    }
</style>

<div class="ui-widget ui-widget-header" style="height: 110px;">
    <h:form>
        <div id="logo">
            <h:panelGrid columns="2" width="100%">
                <a href="${request.contextPath}/home.faces">
                   <img src="${request.contextPath}/resources/images/headerbg1.jpg" />
                </a>
               <!--  <h:panelGrid columns="1" cellspacing="5">
                </h:panelGrid> -->

                <h:panelGroup styleClass="logoutWelcomeId">
                    <sec:isAuthenticated>
                        <p:commandLink value="#{msgs.admin_loggedinas} #{userSession.loggedInUser} |"/>
                        <p:commandLink action="#{userSession.editUser}" value="#{msgs.admin_settings} |"
                                       immediate="true"
                                       ajax="false">
                            <f:setPropertyActionListener value="#{userSession.userAccess.user}"
                                                         target="#{registerUserMbean.user}"/>
                        </p:commandLink>
                        <p:commandLink action="#{userAuthHandler.logout}" value="#{msgs.admin_logout}" ajax="false"/>
                    </sec:isAuthenticated>
                    <sec:isAnonymous>
                        <h:panelGrid columns="1">
								<h:outputLink id="loginLink" value="javascript:void(0)"
									onclick="PF('logindlg').show()" title="login">
									<p:graphicImage value="/resources/images/log_in.png" />
								</h:outputLink>
							</h:panelGrid>
                    </sec:isAnonymous>
                </h:panelGroup>
            </h:panelGrid>
        </div>
    </h:form>
</div>

<div>
    <h:form prependId="false">
        <p:menubar>
            <p:menuitem value="#{msgs.label_home}" url="/home.faces" icon="ui-icon-home"/>

            <p:submenu label="#{msgs.Registration}">
                <p:menuitem value="#{msgs.Registration}" icon="ui-icon-home" url="/public/registrationhome.faces"
                            ajax="false"/>
                <p:menuitem value="#{msgs.registration_applicant}" icon="ui-icon-document"
                            url="/public/applicantlist.faces"
                            ajax="false"/>
                <p:menuitem value="#{msgs.registration_product}" icon="ui-icon-document" url="/public/productlist.faces"
                            ajax="false"/>
                <p:menuitem value="#{msgs.susp_prod}" icon="ui-icon-document" url="/public/suspendedproducts.faces"
                            ajax="false"/>
                <p:menuitem value="#{msgs.revoke_prod}" icon="ui-icon-document" url="/public/revokedproducts.faces"
                            ajax="false"/>
                <p:separator/>
                <sec:isAuthenticated>
                    <p:submenu label="#{msgs.registration_form}"
                               rendered="#{userSession.general||userSession.company||userSession.admin||userSession.staff}">
                        <p:menuitem value="#{msgs.product_registration_form}" icon="ui-icon-gear"
                                    url="/secure/prodreginit.faces" ajax="false"/>
                        <p:menuitem value="#{msgs.applicant_registration_form}"
								icon="ui-icon-gear" url="/secure/applicantform.faces"
								ajax="false" rendered="#{userSessionService.displayAppReg(userSession)}" >
						</p:menuitem>
                    </p:submenu>

                    <p:separator/>
                    <p:submenu label="#{msgs.current_applications}"
                               rendered="#{userSession.company||userSession.admin}">
                        <p:menuitem value="#{msgs.submitted_applications}" icon="ui-icon-document"
                                    url="/secure/submittedproducts.faces"/>
                        <p:menuitem value="#{msgs.saved_applications}" icon="ui-icon-document"
                                    url="/secure/savedproducts.faces"/>
                    </p:submenu>
                    <p:separator/>

                    <p:submenu label="#{msgs.reg_processing}"
                               rendered="#{userSession.admin||userSession.staff||userSession.reviewer||userSession.moderator||userSession.lab}">
                        <p:menuitem value="#{msgs.process_review_list}" icon="ui-icon-document"
                                    url="/internal/processreviewlist.faces" rendered="#{userSession.reviewer}"/>
                        <p:menuitem value="#{msgs.reviewers_report}" icon="ui-icon-document"
                                    url="/internal/reviewreport.faces"
                                    rendered="#{userSession.moderator||userSession.head}"/>
                        <p:menuitem value="#{msgs.product_reg_process}" icon="ui-icon-document" rendered="#{!userSession.reviewer}"
                                    url="/internal/processprodlist.faces"/>
                        <p:menuitem value="#{msgs.applicant_reg_process}" icon="ui-icon-document"
                                    url="/internal/processapplist.faces"
                                    rendered="#{userSessionService.displayListAppOnReg(userSession)}"/>
                    </p:submenu>

                    <p:separator/>
                    <p:submenu label="#{msgs.post_reg_proces}"
                               rendered="#{userSession.admin||userSession.staff||userSession.moderator}">
                        <p:menuitem value="#{msgs.process_amdmt}" icon="ui-icon-document"
                                    url="/internal/amdmtlist.faces"/>
                        <p:menuitem value="#{msgs.reg_expiring}" icon="ui-icon-document"
                                    url="/internal/regexpiring.faces"/>
                        <p:menuitem value="#{msgs.payment_notfied}" icon="ui-icon-document"
                                    url="/internal/paymentnotified.faces"/>
                        <p:menuitem value="#{msgs.reg_expired}" icon="ui-icon-document"
                                    url="/internal/expiredreg.faces"/>
 
                    </p:submenu>
                </sec:isAuthenticated>
            </p:submenu>

            <sec:isAuthenticated>
                <p:submenu label="#{msgs.Admin}" icon="ui-icon-key" rendered="#{userSession.admin}">
                    <p:menuitem value="#{msgs.admin_onlineusers}" url="/admin/loggedinuser_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                    <p:menuitem value="#{msgs.Userlist}" url="/admin/userslist_bk.faces" icon="ui-icon-gear"
                                ajax="false"/>
                    <p:menuitem value="#{msgs.admin_rolelist}" url="/admin/rolelist_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                    <p:menuitem value="#{msgs.admin_useraccess}" url="/admin/useraccesslist_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                </p:submenu>
            </sec:isAuthenticated>

        </p:menubar>

        <p:dialog id="dialog" header="Login" widgetVar="logindlg" dynamic="true">

            <table align="center">
                <tr>
                    <td>
                        <h:outputLabel value="Username:" for="j_username"/>

                    </td>
                    <td>
                        <p:inputText id="j_username" required="true"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <h:outputLabel value="Password:" for="j_password"/>

                    </td>
                    <td>
                        <h:inputSecret id="j_password" required="true">
                        </h:inputSecret>
                    </td>
                </tr>

                <tr>
                    <td>

                        <h:outputLabel for="_spring_security_remember_me"
                                       value="Remember me"/>
                    </td>
                    <td>
                        <h:selectBooleanCheckbox
                                id="_spring_security_remember_me"/>
                    </td>

                </tr>
<ui:remove>
					<tr>
						<td><p:commandLink action="#{userMBean.goToResetPwd}"
								value="#{msgs.reset_password}" ajax="false" immediate="true" />
						</td>

					</tr>
</ui:remove>
                <tr>
                    <td>
                        <p:commandButton
                                type="submit"
                                id="login"
                                action="#{userAuthHandler.doLogin}"
                                value="Login" ajax="false"/>
                    </td>
                </tr>
            </table>

        </p:dialog>
    </h:form>
</div>


</ui:composition>
