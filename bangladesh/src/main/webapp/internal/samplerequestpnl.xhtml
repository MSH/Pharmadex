<!-- Creates the table with passed in values of product -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" 
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <!--Button panel -->
    <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="10" cellspacing="10" rendered="#{userSession.moderator||userSession.head||userSession.admin}">
        <p:outputLabel value="#{msgs.sample_test_result_rec}" styleClass="label" for="sampletestrecieved"/>
        <p:selectBooleanButton id="sampletestrecieved" disabled="#{processProdBnMZ.disableCheckSample}"
                               value="#{processProdBn.prodApplications.sampleTestRecieved}"
                               onLabel="#{msgs.global_yes}" offLabel="#{msgs.global_no}"
                               valueChangeListener="#{sampleTestBn.createConfirmLetter}"
                               onIcon="ui-icon-check"
                               offIcon="ui-icon-close" style="width:60px">
            <p:ajax  update="@parent"
                    listener="#{processProdBn.changeSampleRecieved}"/>
        </p:selectBooleanButton>
    </h:panelGrid>

    <p:commandButton action="#{sampleTestBn.initSampleAdd}" value="#{msgs.request_sampletest}"
                     oncomplete="PF('addSampleTestDlg').show()"
                     disabled="#{processProdBnMZ.disableCheckSample}"/>

    <p:dataTable id="sampletable" var="sample" value="#{sampleTestBn.sampleTests}" editable="true"
                 style="margin-bottom:20px">
        <f:facet name="header">
            #{msgs.sample_test_result}
        </f:facet>
        <p:column headerText="#{msgs.requested_date}">
            <p:commandLink id="viewLink2"
                           action="/internal/lab/sampletestdetail.faces"
                           ajax="false" immediate="true">
                <f:param name="sampleTestID" value="#{sample.id}"/>
                <f:param name="backTo" value="#{backTo}"/>
                <p:outputLabel value="#{sample.reqDt}">
                    <f:convertDateTime pattern="MMM dd, yyyy"/>
                </p:outputLabel>
            </p:commandLink>
        </p:column>

        <p:column>
            <f:facet name="header">
                <h:outputText value="#{msgs.global_curr_status}"/>
            </f:facet>
            <h:outputText value="#{msgs[sample.sampleTestStatus.key]}"/>
        </p:column>

        <p:column headerText="#{msgs.created_by}">
            <p:outputLabel value="#{sample.createdBy.name}"/>
        </p:column>

        <p:column headerText="#{msgs.sampletest_recieved}">
            <p:outputLabel value="#{sample.recievedDt}"
                           converter="javax.faces.DateTime"/>
        </p:column>

    </p:dataTable>

    <p:dialog header="#{msgs.sample_test_result}" widgetVar="addSampleTestDlg" id="addSampleTestDlg"
              modal="true" dynamic="true" resizable="false" width="800px">
        <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="10" cellspacing="10"
         			columnClasses="label value">
            <p:outputLabel value="#{msgs.item_requested}" for="itm_req"/>
            <p:selectManyCheckbox id="itm_req" value="#{sampleTestBn.sampleTest.sampleTypes}" layout="grid"
                                  columns="2"
                                  converter="omnifaces.GenericEnumConverter">
                <f:selectItems value="#{globalLists.sampleTypes}" var="type" itemLabel="#{msgs[type.key]}"
                               itemValue="#{type}"/>
                <f:attribute name="collectionType" value="java.util.ArrayList"/>
            </p:selectManyCheckbox>


            <p:outputLabel value="#{msgs.Sample_detail}" for="revsummary" styleClass="label"/>
            <pe:ckEditor id="revsummary" value="#{sampleTestBn.sampleComment.comment}"
								 height="200" width="650"
								 toolbar="[['PasteText','PasteFromWord','-','Bold', '-','NumberedList', 'BulletedList']]"
								 required="true" />
        </h:panelGrid>
        <p:commandButton value="#{msgs.global_submit}" action="#{sampleTestBnMZ.addSample}"
                         oncomplete="PF('reviewDlg').hide()" ajax="false"/>
    </p:dialog>
</ui:composition>
