<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:sec="http://www.springframework.org/security/facelets/tags">
<title>#{msgs.header_title}</title>
<h:outputStylesheet library="css" name="standard.css"/>
<h:outputScript library="js" name="calendar.js"/>
<style>
    ul.ui-menu-child {
        white-space: nowrap;
        width: 220px !important;
    }
</style>


<div class="ui-widget ui-widget-header" style="height: 130px;">
    <h:form>
        <div id="logo">
            <h:panelGrid columns="3" width="100%">
                <a href="${request.contextPath}/public/registrationhome.faces">
                    <img src="${request.contextPath}/resources/images/header.png"/>
                </a>
                <h:panelGrid columns="1" cellspacing="5">
                </h:panelGrid>

                <h:panelGroup styleClass="logoutWelcomeId">
                    <sec:isAuthenticated>
                        <p:commandLink value="#{msgs.admin_loggedinas} #{userSession.loggedInUser} |"></p:commandLink>
                        <p:commandLink action="#{userSession.editUser}" value="#{msgs.admin_settings} |"
                                       immediate="true"
                                       ajax="false">
                            <f:setPropertyActionListener value="#{userSession.userAccess.user}"
                                                         target="#{registerUserMbean.user}"/>
                        </p:commandLink>
                        <p:commandLink action="#{userAuthHandler.logout}" value="#{msgs.admin_logout}" ajax="false"/>
                    </sec:isAuthenticated>
                    <sec:isAnonymous>
                        <h:panelGrid columns="1">
                            <h:outputLink id="loginLink" value="javascript:void(0)"
                                          onclick="PF('logindlg').show()"
                                          title="login">
                                <p:graphicImage value="/resources/images/log_in.png"/>
                            </h:outputLink>
                        </h:panelGrid>
                    </sec:isAnonymous>
                </h:panelGroup>
            </h:panelGrid>
        </div>
    </h:form>
</div>

<div>
    <h:form prependId="false">
        <p:menubar>
            <p:menuitem value="#{msgs.label_home}" url="/home.faces" icon="ui-icon-home"/>

            <p:submenu label="#{msgs.Registration}">
				<p:menuitem value="#{msgs.Registration}" icon="ui-icon-home" url="/public/registrationhome.faces"
                            ajax="false"/>
                            
				<ui:decorate template="/templates/registration_menu.xhtml">
            		<ui:param name="isleftmenu" value="#{false}"/>
        		</ui:decorate>
            </p:submenu>

            <sec:isAuthenticated>
                <p:submenu label="#{msgs.Admin}" icon="ui-icon-key" rendered="#{userSession.admin}">
                    <p:menuitem value="#{msgs.admin_onlineusers}" url="/admin/loggedinuser_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                    <p:menuitem value="#{msgs.Userlist}" url="/admin/userslist_bk.faces" icon="ui-icon-gear"
                                ajax="false"/>
                    <p:menuitem value="#{msgs.admin_rolelist}" url="/admin/rolelist_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                    <p:menuitem value="#{msgs.admin_useraccess}" url="/admin/useraccesslist_bk.faces"
                                icon="ui-icon-document" ajax="false"/>
                </p:submenu>
            </sec:isAuthenticated>

        </p:menubar>

        <p:dialog id="dialog" header="Login" widgetVar="logindlg">

            <table align="center">
                <tr>
                    <td>
                        <h:outputLabel value="Username:" for="j_username"/>

                    </td>
                    <td>
                        <p:inputText id="j_username" required="true"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <h:outputLabel value="Password:" for="j_password"/>

                    </td>
                    <td>
                        <h:inputSecret id="j_password" required="true">
                        </h:inputSecret>
                    </td>
                </tr>

                <tr>
                    <td>

                        <h:outputLabel for="_spring_security_remember_me"
                                       value="Remember me"/>
                    </td>
                    <td>
                        <h:selectBooleanCheckbox
                                id="_spring_security_remember_me"/>
                    </td>

                </tr>
<ui:remove>
                <tr>
                    <td>

                        <p:commandLink action="#{userMBean.goToResetPwd}" value="#{msgs.reset_password}"
                                       ajax="false" immediate="true"/>
                    </td>

                </tr>
</ui:remove>
                <tr>
                    <td>
                        <p:commandButton
                                type="submit"
                                id="login"
                                action="#{userAuthHandler.doLogin}"
                                value="Login" ajax="false"/>
                    </td>
                </tr>
            </table>

        </p:dialog>
    </h:form>
</div>


</ui:composition>
