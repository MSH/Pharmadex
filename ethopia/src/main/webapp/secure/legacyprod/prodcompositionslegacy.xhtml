<!-- Creates the table with passed in values of product -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">


        <p:panel id="appDetailPnl">
                <h:panelGrid id="adddetailgrid" columns="2" style="width: 100%;" cellspacing="10"
                             columnClasses="label value">
                    <p:outputLabel value="#{msgs.new_chemical_name}" styleClass="label"
                                   rendered="#{reRegBean.product.newChemicalEntity}"/>
                    <p:inputText id="nceInput" value="#{reRegBean.product.newChemicalName}"
                                 style="width: 300px;"
                                 rendered="#{reRegBean.product.newChemicalEntity}"/>

                    <!-- INN - active ingridients -->
                    <h:outputLabel value="#{msgs.active_substance}" style="width: 60px;" styleClass="label"/>
                    <p:dataTable id="inntable" var="prodInn" value="#{reRegBean.selectedInns}"
                                 style="width:100%;" editable="true"
                                 update=":rereg:inntable"
                                 emptyMessage="No Inns selected">

                        <f:facet name="header">
                            <p:commandLink value="#{msgs.global_add}*" action="#{reRegBean.openAddInn}"
                                           id="addInnBtn"
                                           oncomplete="PF('addInnDlg').show()"
                                           update=":addInnFrm"/>
                        </f:facet>

                        <p:ajax event="rowEdit" listener="#{reRegBean.onRowEdit}"
                              />
                        <p:ajax event="rowEditCancel" listener="#{reRegBean.onRowCancel}"
                              />

                        <p:column headerText="#{msgs.product_innname}">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodInn.inn.name}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodInn.inn.name}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>

                        </p:column>

                        <p:column headerText="#{msgs.dos_strength}" style="width: 50px;">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodInn.dosStrength}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodInn.dosStrength}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <p:column headerText="#{msgs.dos_unit}" style="width: 50px;">
                            <h:outputText value="#{prodInn.dosUnit.uom}"/>
                        </p:column>

                        <p:column headerText="#{msgs.inn_ref}" style="width: 80px;">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodInn.refStd}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodInn.refStd}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <p:column style="width:32px">
                            <p:rowEditor/>
                        </p:column>

                        <p:column style="width:32px">
                            <p:commandLink action="#{reRegBean.removeInn(prodInn)}"
                                           styleClass="ui-icon ui-icon-trash"
                                           update=":rereg:growl"
                                           immediate="true">
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>

                    <!-- Inactive substance  -->
                    <h:outputLabel value="#{msgs.product_active}" style="width: 60px;" styleClass="label"/>
                    <p:dataTable id="expnttable" var="prodExp" value="#{reRegBean.selectedExipients}"
                                 style="width:100%;" editable="true"
                                 emptyMessage="#{msgs.prod_expnt_not_selected}">
                        <f:facet name="header">
                            <p:commandLink value="#{msgs.global_add}" action="#{reRegBean.openAddExp}"
                                           id="addExpBtn"
                                           oncomplete="PF('addExpntDlg').show()" update=":addExpFrm"/>
                        </f:facet>

                        <p:ajax event="rowEdit" listener="#{reRegBean.onRowEdit}"
                                update=":rereg:messages :rereg:growl"/>
                        <p:ajax event="rowEditCancel" listener="#{reRegBean.onRowCancel}"
                                update=":rereg:messages"/>

                        <p:column headerText="#{msgs.excipient_name}">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodExp.excipient.name}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodExp.excipient.name}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <p:column headerText="#{msgs.dos_strength}">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodExp.dosStrength}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodExp.dosStrength}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <p:column headerText="#{msgs.dos_unit}">
                            <h:outputText value="#{prodExp.dosUnit.uom}"/>
                        </p:column>

                        <p:column headerText="#{msgs.inn_funct}">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodExp.function}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodExp.function}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <p:column headerText="#{msgs.inn_ref}">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{prodExp.refStd}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{prodExp.refStd}" style="width:100%"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>


                        <p:column style="width:32px">
                            <p:rowEditor/>
                        </p:column>

                        <p:column style="width:32px">
                            <p:commandLink action="#{reRegBean.removeExcipient(prodExp)}"
                                           styleClass="ui-icon ui-icon-trash"
                                           update=":rereg:expnttable :rereg:growl" immediate="true">
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>
                    
                    <!-- ATC data  -->
                    <h:outputLabel value="#{msgs.atc_header}" style="width: 60px;" styleClass="label"/>
                    <h:panelGrid columns="3" cellspacing="10">
                        <h:outputLabel value="#{msgs.atc_noatc}: " for="noatc"/>
                        <p:selectBooleanCheckbox id="noatc"
                                  value="#{reRegBean.product.noAtc}"> 
                        </p:selectBooleanCheckbox>
                        <p:commandLink id="atcLookUpBtn" value="#{msgs.atc_lookup}"
                                       oncomplete="PF('addAtcDlg').show()"
                                       action="#{reRegBean.openAddATC}"/>
                    </h:panelGrid>
                    <h:outputLabel/>

                    <p:dataTable id="atctable" var="atc" value="#{reRegBean.selectedAtcs}"
                                 style="width:100%;">
                        <p:column headerText="#{msgs.atc_code}">
                            <h:outputText value="#{atc.atcCode}"/>
                        </p:column>

                        <p:column headerText="#{msgs.atc_name}">
                            <h:outputText value="#{atc.atcName}"/>
                        </p:column>

                        <p:column>
                            <p:commandButton action="#{reRegBean.removeAtc(atc)}"
                                             value="#{msgs.global_delete}"
                                             update=":reghome:atctable :reghome:inntable :reghome:growl"
                                             immediate="true">
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>
                </h:panelGrid>
            <h:panelGrid columns="3" cellspacing="10px" cellpadding="10px" columnClasses="label, value" styleClass="grid">
                <p:outputLabel value="#{msgs.prod_indications}" for="indication" />
                <p:inputTextarea id="indication" value="#{reRegBean.product.indications}" cols="100"/>
                <p:outputLabel/>

                <p:outputLabel value="#{msgs.prod_posology}" for="posology"/>
                <p:inputTextarea id="posology" value="#{reRegBean.product.posology}" cols="100"/>
                <p:outputLabel/>

                <p:outputLabel value="#{msgs.product_shelflife}" for="shelflife"/>
                <p:inputText id="shelflife" value="#{reRegBean.product.shelfLife}"/>
                <p:message for="shelflife" showSummary="true" showDetail="false"/>

                <p:outputLabel value="#{msgs.product_drug_type}" for="cbdrugtype"/>
                <p:selectOneMenu id="cbdrugtype" value="#{reRegBean.product.drugType}">
                    <f:selectItem itemLabel="-" itemValue=""/>
                    <f:selectItems value="#{globalLists.drugTypes}" var="dt" itemLabel="#{msgs[dt.key]}"/>
                </p:selectOneMenu>
                <p:message for="cbdrugtype" showSummary="true" showDetail="false"/>

                <p:outputLabel value="#{msgs.product_packsize}" for="inpacksize"/>
                <p:inputText id="inpacksize" value="#{reRegBean.product.packSize}" style="width: 300px"/>
                <p:message for="inpacksize" showSummary="true" showDetail="false"/>


                <p:outputLabel value="#{msgs.product_conttype}" for="inconttype"/>
                <p:inputTextarea id="inconttype" value="#{reRegBean.product.contType}" style="width: 300px"/>
                <p:message for="inconttype" showSummary="true" showDetail="false"/>

                <p:outputLabel value="#{msgs.product_storcndtn}" for="instorecndtn"/>
                <p:inputText id="instorecndtn" value="#{reRegBean.product.storageCndtn}" style="width: 300px"/>
                <p:message for="instorecndtn" showSummary="true" showDetail="false"/>
            </h:panelGrid>
        </p:panel>
</ui:composition>
